# üîç –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ Tier –ü—ñ–¥–ø–∏—Å–æ–∫ –Ω–∞ –ü—Ä–æ–¥–∞–∫—à–∏–Ω—ñ

–¶–µ–π –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—É—î —è–∫ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –≤—Å—ñ tier –ø—ñ–¥–ø–∏—Å–∫–∏ –ø—Ä–∞—Ü—é—é—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–æ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–∏–Ω—ñ.

## üìã –î–æ—Å—Ç—É–ø–Ω—ñ Tier –ü—ñ–¥–ø–∏—Å–∫–∏

–£ –ø—Ä–æ–µ–∫—Ç—ñ Astroline —î —Ç—Ä–∏ tier –ø—ñ–¥–ø–∏—Å–∫–∏:

1. **trial_1w** - 1 –¢–∏–∂–¥–µ–Ω—å (42 ‚Ç¥)
2. **trial_2w** - 2 –¢–∏–∂–Ω—ñ (229 ‚Ç¥) - –ù–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–∏–π
3. **trial_4w** - 4 –¢–∏–∂–Ω—ñ (419 ‚Ç¥) - –ù–∞–π–≤–∏–≥—ñ–¥–Ω—ñ—à–∏–π

## üöÄ –®–≤–∏–¥–∫–∞ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ (–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞)

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è PowerShell —Å–∫—Ä–∏–ø—Ç—É

```powershell
# –ó–∞–ø—É—Å—Ç—ñ—Ç—å —Å–∫—Ä–∏–ø—Ç –∑ URL –ø—Ä–æ–¥–∞–∫—à–∏–Ω—É
.\scripts\test-subscription-tiers.ps1 -ProductionUrl "https://your-site.vercel.app"

# –ê–±–æ –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ (—Å–∫—Ä–∏–ø—Ç –∑–∞–ø–∏—Ç–∞—î URL)
.\scripts\test-subscription-tiers.ps1
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ:
1. –°—Ç–≤–æ—Ä–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–∏–π –∑–≤—ñ—Ç
2. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç—å –≤—Å—ñ —Ç—Ä–∏ tier –ø—ñ–¥–ø–∏—Å–∫–∏
3. –ü–æ–∫–∞–∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏

## üîß –†—É—á–Ω–∞ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

### –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–µ—Ä–µ–∑ UI

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –≤–∞—à –ø—Ä–æ–¥–∞–∫—à–∏–Ω URL: `https://your-site.vercel.app`
2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ –∫–≤—ñ–∑—É: `/quiz`
3. –ó–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è –∫–≤—ñ–∑—É
4. –î—ñ–π–¥—ñ—Ç—å –¥–æ –∫—Ä–æ–∫—É Paywall (–ø—ñ—Å–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∑–≤—ñ—Ç—É)
5. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è –≤—Å—ñ —Ç—Ä–∏ –ø–ª–∞–Ω–∏:
   - ‚úÖ 1 –¢–∏–∂–¥–µ–Ω—å (42 ‚Ç¥)
   - ‚úÖ 2 –¢–∏–∂–Ω—ñ (229 ‚Ç¥) - –º–∞—î –±—É—Ç–∏ –ø–æ–∑–Ω–∞—á–µ–Ω–∏–π —è–∫ "–ù–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–∏–π"
   - ‚úÖ 4 –¢–∏–∂–Ω—ñ (419 ‚Ç¥) - –º–∞—î –±—É—Ç–∏ –ø–æ–∑–Ω–∞—á–µ–Ω–∏–π —è–∫ "–ù–∞–π–≤–∏–≥—ñ–¥–Ω—ñ—à–∏–π"

### –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–µ—Ä–µ–∑ API

–î–ª—è –∫–æ–∂–Ω–æ–≥–æ –ø–ª–∞–Ω—É –≤–∏–∫–æ–Ω–∞–π—Ç–µ POST –∑–∞–ø–∏—Ç –¥–æ `/api/monobank/create-payment`:

#### –ü–ª–∞–Ω 1: trial_1w

```bash
curl -X POST https://your-site.vercel.app/api/monobank/create-payment \
  -H "Content-Type: application/json" \
  -d '{
    "planId": "trial_1w",
    "reportId": "YOUR_REPORT_ID",
    "email": "test@example.com",
    "sunSign": "Leo",
    "moonSign": "Aries",
    "risingSign": "Gemini"
  }'
```

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "success": true,
  "invoiceId": "some-invoice-id",
  "pageUrl": "https://pay.monobank.ua/...",
  "reference": "ASTRO-..."
}
```

#### –ü–ª–∞–Ω 2: trial_2w

```bash
curl -X POST https://your-site.vercel.app/api/monobank/create-payment \
  -H "Content-Type: application/json" \
  -d '{
    "planId": "trial_2w",
    "reportId": "YOUR_REPORT_ID",
    "email": "test@example.com",
    "sunSign": "Leo",
    "moonSign": "Aries",
    "risingSign": "Gemini"
  }'
```

#### –ü–ª–∞–Ω 3: trial_4w

```bash
curl -X POST https://your-site.vercel.app/api/monobank/create-payment \
  -H "Content-Type: application/json" \
  -d '{
    "planId": "trial_4w",
    "reportId": "YOUR_REPORT_ID",
    "email": "test@example.com",
    "sunSign": "Leo",
    "moonSign": "Aries",
    "risingSign": "Gemini"
  }'
```

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏

### –ë–∞–∑–æ–≤–∞ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

- [ ] –í—Å—ñ —Ç—Ä–∏ –ø–ª–∞–Ω–∏ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è –≤ UI (PaywallStep)
- [ ] –í—Å—ñ —Ç—Ä–∏ –ø–ª–∞–Ω–∏ –º–∞—é—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ñ —Ü—ñ–Ω–∏:
  - [ ] trial_1w: 42 ‚Ç¥
  - [ ] trial_2w: 229 ‚Ç¥
  - [ ] trial_4w: 419 ‚Ç¥
- [ ] –í—Å—ñ —Ç—Ä–∏ –ø–ª–∞–Ω–∏ –º–∞—é—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –Ω–∞–∑–≤–∏ —Ç–∞ –æ–ø–∏—Å–∏
- [ ] –ü–ª–∞–Ω trial_2w –ø–æ–∑–Ω–∞—á–µ–Ω–∏–π —è–∫ "–ù–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–∏–π"
- [ ] –ü–ª–∞–Ω trial_4w –ø–æ–∑–Ω–∞—á–µ–Ω–∏–π —è–∫ "–ù–∞–π–≤–∏–≥—ñ–¥–Ω—ñ—à–∏–π"

### API –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

- [ ] POST `/api/monobank/create-payment` –∑ `planId: "trial_1w"` –ø–æ–≤–µ—Ä—Ç–∞—î —É—Å–ø—ñ—à–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å
- [ ] POST `/api/monobank/create-payment` –∑ `planId: "trial_2w"` –ø–æ–≤–µ—Ä—Ç–∞—î —É—Å–ø—ñ—à–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å
- [ ] POST `/api/monobank/create-payment` –∑ `planId: "trial_4w"` –ø–æ–≤–µ—Ä—Ç–∞—î —É—Å–ø—ñ—à–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å
- [ ] –í—Å—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –º—ñ—Å—Ç—è—Ç—å `invoiceId`, `pageUrl`, —Ç–∞ `reference`
- [ ] `pageUrl` –≤–µ–¥–µ –Ω–∞ Monobank payment page

### –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∞ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

- [ ] –ü—Ä–∏ –≤–∏–±–æ—Ä—ñ –ø–ª–∞–Ω—É —Ç–∞ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ "–û—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø" –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è Monobank payment page
- [ ] –ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ—ó –æ–ø–ª–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –Ω–∞ `/payment/success`
- [ ] –ü—ñ—Å–ª—è –æ–ø–ª–∞—Ç–∏ –∑–≤—ñ—Ç —Ä–æ–∑–±–ª–æ–∫–æ–≤—É—î—Ç—å—Å—è (–≤—Å—ñ —Å–µ–∫—Ü—ñ—ó –¥–æ—Å—Ç—É–ø–Ω—ñ)
- [ ] Email –∑–≤—ñ—Ç—É –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –ø—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ—ó –æ–ø–ª–∞—Ç–∏

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –í—Å—ñ –ø–ª–∞–Ω–∏ –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å –ø–æ–º–∏–ª–∫—É

**–ú–æ–∂–ª–∏–≤—ñ –ø—Ä–∏—á–∏–Ω–∏:**
1. `MONOBANK_TOKEN` –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ Vercel
2. `SKIP_PAYMENT` –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ `true` (—Ç–µ—Å—Ç–æ–≤–∏–π —Ä–µ–∂–∏–º)
3. `NEXT_PUBLIC_BASE_URL` –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ Environment Variables –≤ Vercel Dashboard
2. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å —â–æ `MONOBANK_TOKEN` –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –¥–ª—è Production
3. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å —â–æ `SKIP_PAYMENT` –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∞–±–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ `false`
4. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å —â–æ `NEXT_PUBLIC_BASE_URL` –≤–∫–∞–∑—É—î –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π URL

### –ü—Ä–æ–±–ª–µ–º–∞: –û–¥–∏–Ω –∑ –ø–ª–∞–Ω—ñ–≤ –Ω–µ –ø—Ä–∞—Ü—é—î

**–ú–æ–∂–ª–∏–≤—ñ –ø—Ä–∏—á–∏–Ω–∏:**
1. –ü–ª–∞–Ω –Ω–µ —ñ—Å–Ω—É—î –≤ `PRICE_PLANS` (–ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ `src/lib/monobank.ts`)
2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π `planId` –≤ –∑–∞–ø–∏—Ç—ñ

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ –ø–ª–∞–Ω —ñ—Å–Ω—É—î –≤ `PRICE_PLANS`:
   ```typescript
   export const PRICE_PLANS = {
     trial_1w: { ... },
     trial_2w: { ... },
     trial_4w: { ... },
   };
   ```
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ `planId` —Ç–æ—á–Ω–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∫–ª—é—á—É –≤ `PRICE_PLANS`

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–ª–∞–Ω–∏ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è, –∞–ª–µ –æ–ø–ª–∞—Ç–∞ –Ω–µ –ø—Ä–∞—Ü—é—î

**–ú–æ–∂–ª–∏–≤—ñ –ø—Ä–∏—á–∏–Ω–∏:**
1. Monobank —Ç–æ–∫–µ–Ω –Ω–µ–≤–∞–ª—ñ–¥–Ω–∏–π –∞–±–æ –∑–∞–∫—ñ–Ω—á–∏–≤—Å—è —Ç–µ—Ä–º—ñ–Ω –¥—ñ—ó
2. Webhook URL –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. Redirect URL –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ Monobank —Ç–æ–∫–µ–Ω –≤ web.monobank.ua
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ `NEXT_PUBLIC_BASE_URL` –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ –≤ Vercel Dashboard ‚Üí Functions ‚Üí `create-payment`

## üìä –î–µ –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ö–æ–¥

### –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ü–ª–∞–Ω—ñ–≤

- **–¶—ñ–Ω–∏ —Ç–∞ ID –ø–ª–∞–Ω—ñ–≤**: `src/lib/monobank.ts` (—Ä—è–¥–∫–∏ 145-161)
- **UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∑ –ø–ª–∞–Ω–∞–º–∏**: `src/components/quiz/steps/PaywallStep.tsx` (—Ä—è–¥–∫–∏ 22-70)
- **API endpoint**: `src/app/api/monobank/create-payment/route.ts`

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –í–∞–ª—ñ–¥–∞—Ü—ñ—ó

API endpoint –≤–∞–ª—ñ–¥—É—î –ø–ª–∞–Ω —Ç–∞–∫:
```typescript
const plan = PRICE_PLANS[planId as PlanId];
if (!plan) {
  return NextResponse.json(
    { error: 'Invalid plan selected' },
    { status: 400 }
  );
}
```

## üéØ –ü—ñ—Å–ª—è –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏

–Ø–∫—â–æ –≤—Å—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—Ä–æ–π—à–ª–∏ —É—Å–ø—ñ—à–Ω–æ:

1. ‚úÖ –í—Å—ñ —Ç—Ä–∏ tier –ø—ñ–¥–ø–∏—Å–∫–∏ –ø—Ä–∞—Ü—é—é—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–æ
2. ‚úÖ –ú–æ–∂–Ω–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–∏ –¥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ä–µ–∞–ª—å–Ω–∏—Ö –ø–ª–∞—Ç–µ–∂—ñ–≤
3. ‚úÖ –ú–æ–∂–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ webhook callback
4. ‚úÖ –ú–æ–∂–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—ñ–¥–ø—Ä–∞–≤–∫—É email –ø—ñ—Å–ª—è –æ–ø–ª–∞—Ç–∏

## üìù –ü—Ä–∏–º—ñ—Ç–∫–∏

- **–¢–µ—Å—Ç–æ–≤–∏–π —Ä–µ–∂–∏–º**: –Ø–∫—â–æ `SKIP_PAYMENT=true`, –æ–ø–ª–∞—Ç–∞ –±—É–¥–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å–∫—ñ–ø–∞—Ç–∏—Å—è. –¶–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è, –∞–ª–µ –Ω–µ –¥–ª—è production!
- **Monobank —Ç–µ—Å—Ç–æ–≤—ñ –ø–ª–∞—Ç–µ–∂—ñ**: Monobank –º–æ–∂–µ –º–∞—Ç–∏ —Ç–µ—Å—Ç–æ–≤—ñ –∫–∞—Ä—Ç–∫–∏ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –±–µ–∑ —Ä–µ–∞–ª—å–Ω–∏—Ö –ø–ª–∞—Ç–µ–∂—ñ–≤
- **–õ–æ–≥–∏**: –ó–∞–≤–∂–¥–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –≤ Vercel Dashboard –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏

---

**–ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä –≤–∏ –∑–Ω–∞—î—Ç–µ —è–∫ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—Å—ñ tier –ø—ñ–¥–ø–∏—Å–∫–∏ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–∏–Ω—ñ! üí≥**
